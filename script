-- Настройки
local bulletSpeed = 100 -- Скорость пули
local traceDuration = 0.5 -- Длительность следа
local traceColor = Color3.new(1, 1, 1) -- Белый цвет следа
local traceTransparency = 0.5 -- Прозрачность следа

-- Функция для создания следа
local function createBulletTrace(startPosition, direction)
    local bullet = Instance.new("Part")
    bullet.Size = Vector3.new(0.2, 0.2, 1)
    bullet.Anchored = true
    bullet.CanCollide = false
    bullet.Transparency = 1
    bullet.CFrame = CFrame.new(startPosition, startPosition + direction)
    bullet.Parent = workspace

    local trail = Instance.new("Trail")
    trail.Attachment0 = Instance.new("Attachment", bullet)
    trail.Attachment1 = Instance.new("Attachment", bullet)
    trail.Attachment1.Position = Vector3.new(0, 0, -1)
    trail.Color = ColorSequence.new(traceColor)
    trail.Transparency = NumberSequence.new(traceTransparency)
    trail.Lifetime = traceDuration
    trail.Parent = bullet

    -- Движение пули
    local startTime = tick()
    local endTime = startTime + 10 -- Максимальное время полета пули (на случай, если она не столкнется)
    
    while tick() < endTime do
        local deltaTime = tick() - startTime
        local newPosition = startPosition + direction * bulletSpeed * deltaTime
        bullet.Position = newPosition

        -- Проверка на столкновение
        local ray = Ray.new(bullet.Position, direction * bulletSpeed * deltaTime)
        local hit, position = workspace:FindPartOnRay(ray, bullet)
        
        if hit then
            bullet:Destroy()
            break
        end

        wait()
    end

    bullet:Destroy()
end

-- Пример использования
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

mouse.Button1Down:Connect(function()
    local startPosition = player.Character.Head.Position
    local direction = (mouse.Hit.p - startPosition).unit
    createBulletTrace(startPosition, direction)
end)
