-- Настройки
local bulletSpeed = 100 -- Скорость пули
local traceDuration = 0.5 -- Длительность следа
local traceColor = Color3.new(1, 1, 1) -- Белый цвет следа
local traceTransparency = 0.5 -- Прозрачность следа

-- Функция для создания следа
local function createBulletTrace(startPosition, direction)
    local bullet = Instance.new("Part")
    bullet.Size = Vector3.new(0.2, 0.2, 1)
    bullet.Anchored = true
    bullet.CanCollide = false
    bullet.Transparency = 1
    bullet.CFrame = CFrame.new(startPosition, startPosition + direction)
    bullet.Parent = workspace

    -- Создаем луч (Beam) для следа
    local attachment0 = Instance.new("Attachment", bullet)
    local attachment1 = Instance.new("Attachment", bullet)
    attachment1.Position = Vector3.new(0, 0, -1)

    local beam = Instance.new("Beam", bullet)
    beam.Attachment0 = attachment0
    beam.Attachment1 = attachment1
    beam.Color = ColorSequence.new(traceColor)
    beam.Transparency = NumberSequence.new(traceTransparency)
    beam.Width0 = 0.1
    beam.Width1 = 0.1

    -- Движение пули
    local startTime = tick()
    local endTime = startTime + 10 -- Максимальное время полета пули

    while tick() < endTime do
        local deltaTime = tick() - startTime
        local newPosition = startPosition + direction * bulletSpeed * deltaTime
        bullet.Position = newPosition

        -- Проверка на столкновение
        local ray = Ray.new(bullet.Position, direction * bulletSpeed * deltaTime)
        local hit, position = workspace:FindPartOnRay(ray, bullet)

        if hit then
            bullet:Destroy()
            break
        end

        wait()
    end

    -- Плавное исчезновение следа
    for i = 1, 10 do
        beam.Transparency = NumberSequence.new(traceTransparency + (i * 0.1))
        wait(traceDuration / 10)
    end

    bullet:Destroy()
end

-- Пример использования
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

mouse.Button1Down:Connect(function()
    local startPosition = player.Character.Head.Position
    local direction = (mouse.Hit.p - startPosition).unit
    createBulletTrace(startPosition, direction)
end)
